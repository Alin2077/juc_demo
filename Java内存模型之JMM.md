b## 面试题
* 你知道什么是java内存模型JMM吗？
* JMM与volatile的关系？
* JMM有哪些特性，分别是什么？
* 为什么要有JMM，为什么出现？作用和功能是什么？
* ***happens-before先行发生原则你有了解过吗？***

## 计算机硬件存储体系
* 运行速度：寄存器>CPU一级缓存(L1)>L2>L3>主存(内存)>本地磁盘(硬盘)>网络
* 不同系统对于这些硬件的数据传输的规则可能不同。
* JVM试图定义一种JMM来 ***屏蔽掉各种硬件和操作系统的内存访问差异，实现Java程序在不同平台下都能达成一致的内存访问效果。***

## Java内存模型 Java Memory Model
* 一种抽象的概念，并不真实存在，仅仅描述的是一组规定或规范。
* 定义了程序中（尤其是多线程）各个变量的读写访问方式兵决定一个线程对共享变量的写入何时以及如何变成对另一个线程可见，关键技术点都是围绕多线程的 ***原子性、可见性和有序性*** 展开的。
* ***实现线程和主内存之间的抽象关系***。

### JMM三大特性
* 可见性  当一个线程修改了某一个共享变量的值，其他线程可以立即看到修改后的值。---JMM规定了所有的变量都存储在 主内存 中，每个线程都在本地内存中读写共享变量的副本。</br>
* 原子性  指一个操作是不可打断的，即多线程环境下，操作不能被其他线程干扰。
* 有序性  程序在最终执行时会经历指令重排序（底层为了运行效率会进行一些优化,会导致重排序）,JVM规范规定JVM内部维持顺序话语义，即保证重排前后的运行结果一样。

## JMM规范下，多线程先行发生原则—— happens-before  --- 实质一种
可见性
* 次序规则  ---  在一个线程内，写在前面的操作先行发生于写在后面的操作，即前面操作的结果可以被后面的操作获取。
* 锁定规则  ---  unLock操作先行发成于对同一把锁的lock。
* volatile变量规则  ---  对于一个volatile变量，写操作对后面的读操作是可见的。
* 传递规则  ---  如果A先于B，而B又先于C，则A先于C
* 线程启动规则（Thread Start Rule）  ---  Thread对象的start()方法先行发生于此线程内的每一个方法
* 线程中断规则（Thread Interruption Rule）  ---  必须要先调用interrupt()，才能通过Thread.interrupted()来检测是否发生中断
* 线程终止规则（Thread Termination Rule）  ---  线程中的所有操作都先行发生于对此线程的终止检测（isAlive()方法可以检测线程是否终止）
* 对象终结规则（Finalizer Rule）  ---  对象的构造方法完成先于对象的finalize方法